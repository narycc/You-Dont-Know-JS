# You Don't Know JS: 起步
# 第一章：程序入门

遵循的翻译规范 ['协作翻译规范'](https://github.com/react-guide/ETC)


**行动** 这一章介绍一些编程的基本概念（当然这里特指JS编程），以及如何阅读和理解这一系列的其他标题。尤其是，如果你刚刚接触JavaScript编程，这本书会带着你去探索入门该做些什么。

这本书以解释较高水平的编程基本准则为开端。这是特意为那些在开始这本书之前没有任何编程经验，并且希望这些书能帮助你以JavaScript的视角理解编程的朋友准备的。

第一章是程序入门的快速介绍。这里也列出了一些非常精彩的编程资源来帮助你更深入的研究这些主题，我支持你在读完这章节之后去学习一下。

你对编程的基本概念了解之后，第二章将引导你熟悉JavaScript的编程风格。第二章介绍了JavaScript是什么，但又不是一个全面的指南，那是这本书剩余的部分要讲的内容。

如果你已将JavaScript 使用的得心应手，可以直接跳到第三章看一眼这本书能学到什么内容。

## 代码

我们开始吧。

程序，通常指”源代码“或者”代码“，是告诉计算机要执行什么任务的一系列特殊命令的集合。代码通常被保存在text 文件中，JavaScript 代码也可以在浏览器的开发者控制台中直接输入，这部分我们会有简短的概述。

计算机语言，也叫语法，规定了正确的格式和命令的组合规则。跟英语教你如何拼写单词，用单词和标点造一个正确的句子是一样的。


### 语句

计算机语言中，一组执行一个特定命令的单词，数字和操作符称为“语句”。在JavaScript 中，语句是这样的：
```js
a = b * 2;
```

`a` 和 `b` 是变量，就像一个个可以存储东西的箱子。在程序中，变量存储值（比如数字24）。就把它们认为是值的占位符。

 `2` 是值本身，叫“字面量”，因为它没有用变量存储。

`=` 和 `*` 是“操作符”，它们执行赋值或者数学计算的操作。

JavaScript 中大部分语句以 `;` 结尾。

`a = b * 2;` 告诉计算机将存储在变量 `b` 中的值乘以`2`然后将得到的结果存储在变量`a`中。

程序就是大量语句的集合，它们共同描述了程序执行的每一步。


### 表达式

语句由一个或者多个表达式组成。表达式可以是一个变量或一个值，也可以是一组由操作符连接的变量和值，例如：

```js
a = b * 2;
```

这个语句包含四个表达式：

* `2` 是一个字面量表达式
* `b` 是一个变量表达式，用于或许它当前的值
* `b * 2` 是一个乘法的算术表达式
* `a = b * 2` 是一个赋值表达式，讲 b * 2 的结果赋值给变量a


如下所示的一个单独的表达式称为表达式语句：
```js
b * 2;
```
这种表达式语句不常见也没多大用处，因为它对程序的执行没有什么影响。它获得b 的值再乘以2，但是得到结果之后没有做任何事情。

一个更为常见的语句叫调用表达式（参见“函数”），函数调用了一个表达式：

```js
alert( a );
```

### 程序的执行

这些程序语句是怎么告诉计算机做什么操作的？程序需要被执行。 

像`a = b * 2` 这样的语句对于开发者来说易于读写，但是计算机理解不了。所以就有了一个特殊的工具用来将我们写的代码转换成计算机能够理解的命令，称为翻译机或者编译器。

一些计算机语言的翻译过程是从上到下逐行进行的，每一次执行程序的过程叫代码解释。

还有一些语言，翻译的过程是先做好，叫作代码编译。所以程序运行的时候其实是运行已经编译好的计算机指令。

JavaScript 执行的过程叫代码解释，因为JavaScript 源代码是每次运行的时候被处理，但并不完全准确。JavaScript 引擎事实上是一边编译源码，一边立马执行编译好的代码。

**贴士** 更多关于JavaScript 编译的信息，参见 **作用域和闭包** 的头两章节。 

## 动动你的小手

这一章将会以代码片段的方式介绍每一个变成的概念，当然所有的例子都是JavaScript 写的。

重要的事情说三遍：当你阅读这一章节内容的时候（或许你会反复阅读好几遍），你一定通过自己动手去写每一段代码来理解这些概念。最简单的方式就是用离你最近的浏览器的开发者工具控制台编写， 火狐，谷歌，IE 浏览器都行。

**贴士：**一般情况下你可以使用快捷键或者从菜单栏来快速打开控制台，[Mastering The Developer Tools Console](http://blog.teamtreehouse.com/mastering-developer-tools-console) 这篇文章有更多关于控制台的开启和使用的详细信息。在控制台下面输入多行代码需要使用`<shift> + <enter>`切换到下一行输入，如果你敲下`<enter>`，控制台会执行你在控制台中输入的内容。

那我们就来熟悉一下控制台下面执行代码的流程。首先，我建议你在浏览器中打开一个空白的面白，我一般会在地址栏中通过输入`about:blank`完成。然后确保你打开了控制台。

现在，输入这些代码，看看它会如何运行：

```js
a = 21;

b = a * 2;

console.log( b );
```

在chrome 浏览器中输入上述的代码，会产生如下所示的结果：

<img src="fig1.png" width="500">

加油，尝试吧。学习编程最好的方式就是开始码代码！
### 输出

在上面的代码片段中，我们使用了`console.log(..)`。让我们来稍微看一下那几行代码到底是什么。

或许你已经猜到了，那就是我们在开发者控制台下面打印文本的方式。我们要解释一下那一句的两个特征。

首先，`log( b )` 部分是一个函数调用。我们把`b` 传入到那个函数当中，并把它的值打印到控制台中。

第二，`console.` 部分是`log(..)` 所属的一个对象引用。 第2章会涵盖对象和属性的内容。

另外一种创建可见输出的方式是运行`alert(..)`，例如：
```js
alert( b );
```

运行，你会发现它不是在console 下面输出内容，而是弹出一个带有“OK”按钮的提示框，里面会显示b 变量的值。`console.log(..)`在学习编码和运行程序时使用起来比`alert(..)`更方便，因为它可以一次打印多个值，而不会影响浏览器界面展示。

这本书我们使用 `console.log(..)` 来输出。

### 输入


我们讨论输出的时候，你是不是对输入（从用户那儿接收信息）也充满好奇？

最常见的方式是在HTML页面上有一组表单元素，比如文本框，用户可以进行输入，然后使用JS 来读这些输入，并传给程序变量。

不过，对于简单的学习和展示，这本书中我们有一种更简便的方式，那就是使用`prompt(..)`函数：
```js
age = prompt( "Please tell me your age:" );

console.log( age );
```

你或许已经猜到了，这个实例中传给`prompt(..)`的信息`"Please tell me your age:"` 会被打印在弹出框中。

结果看起来会像这样：
<img src="fig2.png" width="500">

当你点击“OK”的时候，输入的文本就被提交了，并被存储在`age` 变量中，然后被`console.log(..)`输出：
<img src="fig3.png" width="500">

为了使学习基本编程概念的时候尽量保持简单，我们这本书中的例子不需要输入。但我们已经学会了如何使用`prompt(..)`，所以如果你想挑战自己，你可以在探索实例的时候尝试使用输入。
## 运算符

运算符决定了在变量和值之间执行怎样的运算。我们已经看到过两种JavaScript 的运算符了，`=` 和 `*`。

`*` 执行的是数学乘法运算，是不是很简单？

`=` 等号运算符用于赋值，我们先把右边的值（源值）计算出来，然后赋给左边定义好的变量（目标变量）上。
**警告：** 赋值看起来像是个奇怪的逆序。可能一些语言会把 `a = 42`反过来，把源放在左边目标变量放在右边，如 `42 -> a` （JavaScript 是不合法的）。很不幸，`a = 42` 的顺序不可变，这种形式在现代编程语言中特别流行，如果你感觉不自然，那么你只能花点时间适应这种顺序并习以为常了。

看看下面：

```js
a = 2;
b = a + 1;
```

把`2`赋给变量`a`。然后我们把a 变量的值加1 得到的结果3 存储到变量b 中。

程序中会用到一个非运算符的关键字`var`声明变量。

变量在使用之前需要先声明，但在一个作用域中只需要声明一次，然后在作用域内可以多次使用，例如：

```js
var a = 20;

a = a + 1;
a = a * 2;

console.log( a );	// 42
```

以下是JavaScrip 中最常用的一些运算符：

* 赋值： `=` 如 `a = 2`.
* 数学： `+` （加法）， `-` （减法）， `*` 乘法， 和 `/` （除法）如 `a * 3`.
* 复合运算： `+=`， `-=`， `*=`， 和 `/=` 称为复合运算符，它把数学运算符和赋值结合起来使用，如 `a += 2` 等同于 `a = a + 2`。
* 自增、自减： `++` （自增）， `--` （自减）如 `a++` 等同于 `a = a + 1`。
* 获取对象属性： `.`如 `console.log()`。

   `obj.a` 表示`obj`对象有一个属性名叫 `a`。属性也可以通过`obj["a"]`获取值，参见第二章。
   
* 相等： `==`（相等）， `===` （恒等）， `!=`（不相等） `!==` （不恒等） 如`a == b`.

   参见第二章的“值与类型”。
* 比较运算符： `<` （小于）， `>` （大于）， `<=` （小于等于）， `>=` （大于等于）如 `a <= b`.

    参见第二章的“值与类型”。
* 逻辑运算符：`&&` （且） `||` （或），如 `a || b` 表示 `a` 或 `b`.

这些运算符在表示复合运算条件的时候常用到（参见条件语句），比如判断`a` 或 `b`是否为真。

**说明：** MDN的["Expressions and Operators](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators) 中会有更多关于运算符的详细信息，以及这里没有提到的运算符。

## 值和类型

如果你问一个手机店员一个手机多少钱，他们说99.99美金，他们会给你一个实际的含税价格表示你要买一部手机需要支付的钱。如果你想买两部，那么你马上心算出来两部手机的基本费用是199.98美金。

如果他再拿起另外一款手机告诉你这部手机“免费”，他没有给你一个确切的数字，“免费”的用另外一种表达就是$0.00。

然后你问这部手机是否包含充电器，得到的回答只能是“是”或者“否”。

类似的，在程序中要根据你的目的选择不同的方式表达值。

这些不同的值表达在编程术语中就叫“类型”。JavaScript 为这些原始值提供了内建的类型。

* 当你想做数学预算的时候你需要一个`number` 类型；
* 当你想打印值在屏幕上面，你需要一个`string`类型（一两个字母，单词，或者句子）；
* 当你想做决定的时候，你需要一个`boolean` （`true` 或 `false`）。

源代码中直接包含的内容叫“字面量”。`string` 字面量用双引号或者单引号引起来 -- 唯一的区别是格式偏好。`number`和`boolean` 字面量就表示它的真是内容。

看下面：

```js
"I am a string";
'I am also a string';

42;

true;
false;
```

除了 `string`/`number`/`boolean` 值类型，通常编程语言也提供了 *arrays*，*objects*，*functions*以及其他。本章和接下来的章节会涉及到更多的值和类型的内容。

### 类型转换

假设你有一个`number`类型的值，但是想把它打印在屏幕上，你需要把它转化成`string`，JavaScript 中的这种转换叫“强制转换”。同样，如果有人在一个电子商务网站上的表单中输入了一系列数字字符，它是y一个`string`类型，但是你想在数学运算中使用这个值，你需要把它强制转换成`number`类型。

JavaScript 提供了多种方法进行类型间的强制转换，比如：
```js
var a = "42";
var b = Number( a );

console.log( a );	// "42"
console.log( b );	// 42
```

`Number(..)`（一个内置的函数）显式地将其他类型转换成`number`类型，那样最直接。

但是在比较两个不同类型的值时，那种方式就有争议了，这个时候需要隐式转换。

字符串`"99.99"`和数值`99.99`比较，大部分人都觉得他们应该相等。但是他们并不是完全相等，对吧？这是同一个值的两种不同的表达方式，两个不同的类型。你也可以说他们相等，是吧？

为了帮你弄清楚这种类似的情况，JavaScript 有时候为了类型匹配需要隐式转换。

如果你使用`==` 对`"99.99" == 99.99`进行比较，JavaScript 会把左边的`"99.99"` 转换成数字类型，也就是`99.99`，然后就变成了`99.99 == 99.99`，结果为true。

如果你尚未花时间掌握隐式转换的操作规则，很容易困惑，大部分的JS 开发者并未掌握，因此大多数都感觉隐式转换令人困惑，会引起程序出现意想不到的bug，所以应该尽量避免。这甚至被认为是这个语言设计的一个缺陷。

然而，隐式转换机制是完全可以掌握的，希望认真学习JavaScript 开发的人甚至应该去掌握。一旦你掌握了规则，你不仅不会困惑，而且会写出更好的程序。努力是值得的。

**说明：** 强制转换的话题，会在第二章及第四章中的“类型和语法”中有更多的讨论。 

## 代码注释

手机店员可能会草草写下一些关于一款最新发布的手机的特性或者公司的新计划的笔记。这些笔记只能给内部员工看，不能给客户看的。不过这些笔记以文档的形式描述他们要跟客户说什么，怎么说，为什么，能帮助员工工作更出色。写代码不仅仅是为计算机而写，这是我们学到的最重要的一课。写代码一半是为了编译器通过，一半是写给开发者自己看的。

你的计算机只关心机器编码，编译之后的结果，一系列的0 和1。你可能写了无数程序生成0 和1 序列。你该怎么写程序不仅关系到你自己，也关系到你的其他团队成员，甚至你自己的未来。你该始终坚持不仅仅是写出能正常工作的代码，而是有意义的程序。使用好的变量名和函数名会让你在这条路上走的长远。

另外一个重要的部分就是注释。你的程序中插入了大量的纯文本用来向人解释描述。编译器会忽略这些注释。

关于怎么写好注释有很多观点，我们无法绝对定义全球通用的规则，但是下面一些观察和指南对于写好注释非常有用：

* 没有注释的代码是不完美的；
* 过多的注释（一行代码一行注释）可能暗示这段代码的质量不高；
* 注释应该更多的解释“为什么”而不是“是什么”，也可以在特别复杂的地方解释“怎么做”。

JavaScript有两种类型的注释：单行注释和多行注释。
参见：

```js
// This is a single-line comment

/* But this is
       a multiline
             comment.
                      */
```

单行注释`//`适合在语句的正上方或者行尾写注释。`//`　后面直到行尾的内容都被视为注释（因此会被编译器忽略）。单行注释的内容不做限制。
参见：

```js
var a = 42;		// 42 is the meaning of life
```
`/* .. */`多行注释适合需要对多行代码进行解释的情况。

这是多行注释常用的使用方法：
```js
/* The following value is used because
   it has been shown that it answers
   every question in the universe. */
var a = 42;
```

它也可以出现在一行代码中的任意位置，甚至在代码的中间，因为有结束标志`*/`。例如：
```js
var a = /* arbitrary value */ 42;

console.log( a );	// 42
```

多行注释中唯一不能出现的就是`*/`，因为它会被视作多行注释的结束符。　

你一定要养成写代码注释的习惯开始你的编程学习。这一章剩下的内容，你会看到我使用注释来解释一些东西，你自己的练习中你也要这么做。相信我，看你代码的人会感激你的。

## 变量

多数有用的程序中，特定的任务会调用某个值并对它进行个各种各样的操作，通常我们需要跟踪这个程序流程中会随时发生变化的值。

最简单的方式是将这个放到一个有标志的容器中去，就是所谓的“变量”。之所以叫变量是因为这个容器中的值会随着时间需要发生变化。

在一些编程语言中，定义变量用来存储特定类型的值，比如数字类型，字符串类型，静态类型也叫类型转换，他的好处是保证程序的正确性，避免了值转换时发生的潜在错误。

其他的语言更关注值的类型而不是变量的类型。弱类型，也叫动态类型，运行一个变量在任何时候拥有任何类型的值。它的好处是增加了程序的伸缩性，在程序逻辑流中，不管何时以什么类型生成的值都能用同一个变量表示。

JavaScript 使用后面这种方式：动态类型，意味着变量可以不需要进行类型强制转换，保存任何类型的值。

如之前提到，声明变量用var 语句 -- 声明中没有其他类型信息。参见这个简单的额实例：

```js
var amount = 99.99;

amount = amount * 2;

console.log( amount );		// 199.98

// convert `amount` to a string, and
// add "$" on the beginning
amount = "$" + String( amount );

console.log( amount );		// "$199.98"
```

变量 `amount` 开始的值是`99.99`，然后变为 `amount * 2` 的结果，也就是 `199.98`。

最开始的 `console.log(..)` 命令必须隐式转换数字类型为字符串类型，然后打印出来。

Then the statement `amount = "$" + String(amount)` 语句显式地将值 `199.98` 转换成 `string` 类型，然后在开头加上了字符`"$"`。这时候，`amount` 保存的是 `string` 类型的值 `"$199.98"`，因此第二次的`console.log(..)`语句不需要做任何转换就直接打印出来。

JavaScript 的开发者会注意到`amount`变量既能表示`99.99`，`199.98`也能表示`"$199.98"` 的这种伸缩性。静态类型的狂热者会使用一个单独的类型比如`amountStr` 来表示最后的值`"$199.98"`，因为它的类型变了。

另外，`amount`的值在程序过程中是动态变化的，印证了变量最初的目的：管理程序状态。

换句话说，状态能够捕捉程序运行过程中值发生的变化。

另外一种变量的用法通常是集中设置值，也就是设置常量，声明变量的时候赋上初始值，项目过程中它的值都不发生变化。这些常量通常放在程序的最上面，以便能够在需要改变它的值的时候快速地到最上面去修改。我们约定，常量一般用大写字母表示，单词之间用下划线`_`连接。

下面有一个小实例：


```js
var TAX_RATE = 0.08;	// 8% sales tax

var amount = 99.99;

amount = amount * 2;

amount = amount + (amount * TAX_RATE);

console.log( amount );				// 215.9784
console.log( amount.toFixed( 2 ) );	// "215.98"
```

**说明** 正如`console.log(..)` 的函数`log(..)` 能够以 console 对象属性的形式调用一样，这里的`toFixed(..)`函数能通过数字类型值访问。JavaScript值 的数字类型值不会自动的以美元格式化，引擎不知道你的目的，也没有提供货币的类型。`toFixed(..)` 允许我们确定对十进制数值保留几位小数，必要时转换成字符串类型。

`TAX_RATE` 变量按约定是常量 -- 程序中没有防止它发生变化的特殊机制。但是如果这个城市的消费税上涨到9%，我们可以简单地通过修改`TAX_RATE` 的赋值语句，将其设置成`0.09`， 而不是在程序的多个地方出现`0.08`，然后需要更新时到将所有的`0.08`改成`0.09`。

最新版本的JavaScript （ES6）引入了一种新的声明常量的方式：使用`const` 替代 `var`：

```js
// as of ES6:
const TAX_RATE = 0.08;

var amount = 99.99;

// ..
```
常量就像值不变的变量一样有用，除此之外，常量可以避免在初始设置之外的其他地方修改。如果在第一次声明之后将`TAX_RATE`设置成其他值，程序是不允许这种修改的。（在严格模式，会报错--参见第二章的“严格模式”）。

这种防止错误的方式类似静态类型的类型强制转换，所以你可以看到为什么静态类型在其他语言中的魅力。

**说明** 更多关于不同类型的变量使用，参见这一系列标题为 *类型与语法* 的部分。

## 代码块

如果你要买新手机，手机店员必须要仔细检查一系列步骤来完成下单流程。

类似的，代码中我们要把一系列的代码语句成组放置，这样的一组代码称为“代码块”。JavaScript 中，一个代码块通常是在花括号`{ .. }` 中包含多个语句。参见：

```js
var amount = 99.99;

// a general block
{
	amount = amount * 2;
	console.log( amount );	// 199.98
}
```

这种独立的 `{ .. }` 代码块是有效的，但是在JS程序中并不常见。通常，代码块嵌套在其他一些控制语句中，比如`if`语句或者循环语句。如：

```js
var amount = 99.99;

// is amount big enough?
if (amount > 10) {			// <-- block attached to `if`
	amount = amount * 2;
	console.log( amount );	// 199.98
}
```
下一个章节，我们会解释if 语句，`{ .. }`代码块中两个语句时跟在`if (amount > 10)` 之后的，代码块中的语句只有在if 条件语句成立时执行。

**说明** 不像如`console.log(amount);` 的其他语句，代码块不需要冒号`;`作为结束符。

## 条件语句

“你要再额外购买一个屏保膜吗，只要9.99美元哦？” 热心的手机店员问你。你可能先要看看你钱包或者银行账户的状态来回答那个问题。但是明显，这只是一个是或者否的问题。

我们程序中有很多表示条件语句的方式。

最常用的是if 条件语句。“If 这个条件成立，那么就这么这么做”。例如：

```js
var bank_balance = 302.13;
var amount = 99.99;

if (amount < bank_balance) {
	console.log( "I want to buy this phone!" );
}
```

`if` 语句需要在`( )`中间放置结果为`true` 或 `false` 表达式。 这个程序中的表达式是 `amount < bank_balance`，它的结果是 `true` 还是 `false` 取决于`bank_balance`变量的值。

你还可以提供另外一个选择如果条件不成立，成为“else” 从句。参见：

```js
const ACCESSORY_PRICE = 9.99;

var bank_balance = 302.13;
var amount = 99.99;

amount = amount * 2;

// can we afford the extra purchase?
if ( amount < bank_balance ) {
	console.log( "I'll take the accessory!" );
	amount = amount + ACCESSORY_PRICE;
}
// otherwise:
else {
	console.log( "No, thanks." );
}
```

如果 `amount < bank_balance` 的值为 `true`，将会打印 `"I'll take the accessory!"` ，并且把 `9.99`加到变量`amount`上去。否则的话 `else` 从句只会礼貌的打印出`"No, thanks."`，并且保持 `amount`变量的值不变。

之前提及的“值与类型”，非预期的值类型会被强制转化成预期的类型。if 语句需要一个布尔类型值，但是如果你传入一个非布尔类型值，那么就会被强制转化成布尔值。

JavaScript 定义了一系列视为false 的值，当发生强制转换时，这些值自动转化成false，如 `0`和`""`。另外一些自动转化成true 类型，比如`99.99` 和 `"free"`。更多信息参见第二章“是与非”。

条件语句除了`if`之外还有其他形式。例如，`switch`语句可以表示`if..else` 语句（参见第二章）。循环使用条件语句决定循环继续还是终止。

**说明** 关于测试表达式条件语句中隐式强制转化更深入的信息参见这一系列的“类型与语法”中第四章的内容。

## 循环

忙时，顾客需要排队跟手机店员沟通。如果队伍中任然后等候的人，那么店员只需要继续为下一位顾客服务就好了。

循环一系列操作直到某个特定条件失败，换句话说只要条件成立循环一直进行，这是编程中循环的工作。循环有多种形式，但是他们都满足基本这个基本的行为。

循环包含测试条件和代码块。循环代码块每一次执行成为一次迭代。

例如，`while`循环和`do..while`循环形式阐释了循环的概念，执行代码块语句直到条件不再为true。

```js
while (numOfCustomers > 0) {
	console.log( "How may I help you?" );

	// help the customer...

	numOfCustomers = numOfCustomers - 1;
}

// versus:

do {
	console.log( "How may I help you?" );

	// help the customer...

	numOfCustomers = numOfCustomers - 1;
} while (numOfCustomers > 0);
```

这两个循环的实际区别只有一个，条件语句时在第一个迭代之前（while）还是之后(do..while)检测。

不管哪种方式，只要条件语句测试结果为false，那么下一个迭代就不会执行。如果条件一开始就被设置为false，那么while循环永远不会执行，但是`do..while`会执行一次。

有时有些循环的目的是对一组数据进行计数，比如从0 到9（10个数）。你可以设置循环迭代变量比如i=0， 然后每次循环逐次加1。

**提示** 由于一系列历史原因，编程语言总是从0 而不是从1 开始计数。如果你不熟练这种思维模式，刚开始会特别困扰。花点时间练习从 0 开始计数的方式，直到你习以为然。

每次迭代中条件语句都被测试一次，就像循环中隐藏了一个if 语句。

我们可以使用`break`语句来终止循环，也很容易一不小心创建了一个没有终止机制永远执行的循环。
我们来演示一下：

```js
var i = 0;

// a `while..true` loop would run forever, right?
while (true) {
	// stop the loop?
	if ((i <= 9) === false) {
		break;
	}

	console.log( i );
	i = i + 1;
}
// 0 1 2 3 4 5 6 7 8 9
```

**注意** 这并非是实际使用的形式，它只是用做演示之意。

如果while 或者do..while 能手动完成任务，有另外一种语法形式 for 循环就是为此而生的。

```js
for (var i = 0; i <= 9; i = i + 1) {
	console.log( i );
}
// 0 1 2 3 4 5 6 7 8 9
```

正如所见，它包含两种请款，当前10次(i 的值从0 一直到9 )迭代`i <= 9` 为`true`时的情况，以及当i 的值为10 时，条件立即变成了false的情况。 

for 循环有三个从句，初始化从句（var i=0），条件测试从句（i <= 9），和更新从句（i=i+1）。因此，如果你的循环迭代是做计数，那么for 会更精简并且更容易读懂和书写。

还有其他一些特定的循环方式，依次遍历特定的值，如对象的属性，隐含的条件测试就是是否所有的属性都被处理了。不管循环的形式是怎样的，“循环直到条件失败”的概念一直成立。

## 函数

手机店员可能并没有随身携带计算器来计算税费和最终的购买数量。那是一个需要规定一次并重复使用的任务。大概公司的结账处有这样一些功能来做这件事。

类似的，你的程序会把代码的任务细分成很多可以重复使用的小块，而不是一遍又一遍的重复写这些任务代码。把代码拆成可重复使用的小块叫定义一个`function`。

一个函数通常会给一段代码去一个名字，可以通过调用这个名字执行函数中的代码。参见：

```js
function printAmount() {
	console.log( amount.toFixed( 2 ) );
}

var amount = 99.99;

printAmount(); // "99.99"

amount = amount * 2;

printAmount(); // "199.98"
```

函数可选择性的传入参数，也能选择性的返回值。

```js
function printAmount(amt) {
	console.log( amt.toFixed( 2 ) );
}

function formatAmount() {
	return "$" + amount.toFixed( 2 );
}

var amount = 99.99;

printAmount( amount * 2 );		// "199.98"

amount = formatAmount();
console.log( amount );			// "$99.99"
```

函数`printAmount(..)` 传入一个叫`amt`的参数。函数`formatAmount()` 返回一个值。当然你也可以在一个函数中同时使用传参和返回。

函数通常被用来组织会被调用多次的代码，也可以仅用作把相关联的一系列代码组织到一个命名集合中，就算你只打算调用一次这个函数。

参见：

```js
const TAX_RATE = 0.08;

function calculateFinalPurchaseAmount(amt) {
	// calculate the new amount with the tax
	amt = amt + (amt * TAX_RATE);

	// return the new amount
	return amt;
}

var amount = 99.99;

amount = calculateFinalPurchaseAmount( amount );

console.log( amount.toFixed( 2 ) );		// "107.99"
```

尽管函数 `calculateFinalPurchaseAmount(..)` 只被调用了一次，把它的操作组织到一个单独命名函数中也能让程序的逻辑更加清晰。如果函数中有多个语句，那么函数的好处就更加不言而喻了。

### 作用域

如果你问手机店员要这家店没有的一个手机模型，她可能无法把你想要的这个手机卖给你。她只能获取到她自家店仓库的物品。 你必须要尝试到其他店去看看是否能找到你要的手机。

编程对于这个概念有一个词，叫“作用域”，学术上称为“词法作用域”。在JavaScript中，每个函数只能获取它自身的作用域。 作用域主要是变量和这些变量是如何通过名字访问的规则的集合。只有在那个函数中的代码可以访问那个函数作用域内的变量。

同一个作用域中变量名字必须唯一，一个作用域中不能同时存在两个不同的变量名`a`。但是同一个变量名可以出现在两个不同的作用域中。

```js
function one() {
	// this `a` only belongs to the `one()` function
	var a = 1;
	console.log( a );
}

function two() {
	// this `a` only belongs to the `two()` function
	var a = 2;
	console.log( a );
}

one();		// 1
two();		// 2
```

同时，一个作用域中能嵌套在另一个作用域中，就像生日派对上的小丑能够在一个气球中再吹一个气球一样。如果一个作用被嵌套在另一个作用域中，在最里面作用域的代码可以访问外面的任何变量。参见：

```js
function outer() {
	var a = 1;

	function inner() {
		var b = 2;

		// we can access both `a` and `b` here
		console.log( a + b );	// 3
	}

	inner();

	// we can only access `a` here
	console.log( a );			// 1
}

outer();
```

词法作用域规则描述了一个作用中的代码能够访问自身或者它外面的作用域中的变量。

因此，`inner()`函数中的代码可以同时访问 `a` 和 `b`，但是`outer()`函数中的代码只能访问`a`不能访问`b`，因为`b`的作用域在`inner()` 函数中。

再次回忆下之前的代码片段：

```js
const TAX_RATE = 0.08;

function calculateFinalPurchaseAmount(amt) {
	// calculate the new amount with the tax
	amt = amt + (amt * TAX_RATE);

	// return the new amount
	return amt;
}
```

`TAX_RATE` 常量由于词法作用域可以被 `calculateFinalPurchaseAmount(..)` 函数内部访问，尽管我们并没有将它以参数的形式传进去。 

**说明** 关于词法作用域更多的信息，参见这一系列“作用域和闭包”专题的前三章节。 

## 练习

学习编程，练习明显是无可取代的。我写再多的代码表达也无法让你成为一个程序员。 
 
记住，让我们尝试将这一章节学到的概念练习一遍。我会给出需求，你先尝试。然后再到后面的代码看看我是如果完成的。 

* 写一个程序来计算你购买的手机的总价。 你会不停的买手机（提示：loop）知道你银行账户中的钱用完。你也可以给每部手机买配件，只要你购买总额在你心理预期以内。
* 在你计算购买总额之后，加入税费，然后打印出购买总额，适当的格式化。
* 最后，检查总额和你银行账户余额，看看你是否能支付的起。
* 你要将税费，手机价格，配件价格，开支上限设置成常量，还要将银行账户余额设置成变量。
* 你要定义函数来计算税费，用户“$” 和两位小数格式化价格。

* **附加题：** 尝试在程序中加入输入，可以是前文中提到的`prompt(..)`函数。比如，你可以提示用户输入他们的银行账户余额。享受创造的快乐吧。
好吧，继续，动手吧。不要偷看下面我写的代码，直到你自己完成。


**说明** 因为这是一本JavaScript 书，所以我当然会以JavaScript 语言来解决练习中的问题。但是如果你觉得更习惯的话你也可以先用其他语言完成。

这是我这道习题的解决方法：

```js
const SPENDING_THRESHOLD = 200;
const TAX_RATE = 0.08;
const PHONE_PRICE = 99.99;
const ACCESSORY_PRICE = 9.99;

var bank_balance = 303.91;
var amount = 0;

function calculateTax(amount) {
	return amount * TAX_RATE;
}

function formatAmount(amount) {
	return "$" + amount.toFixed( 2 );
}

// keep buying phones while you still have money
while (amount < bank_balance) {
	// buy a new phone!
	amount = amount + PHONE_PRICE;

	// can we afford the accessory?
	if (amount < SPENDING_THRESHOLD) {
		amount = amount + ACCESSORY_PRICE;
	}
}

// don't forget to pay the government, too
amount = amount + calculateTax( amount );

console.log(
	"Your purchase: " + formatAmount( amount )
);
// Your purchase: $334.76

// can you actually afford this purchase?
if (amount > bank_balance) {
	console.log(
		"You can't afford this purchase. :("
	);
}
// You can't afford this purchase. :(
```

**说明** 运行这些JavaScript 程序最简单直接的方式就是在浏览器的开发者控制台中输入这段代码。

你做的怎么样了？你已经看了我写的代码，不妨再试一次。尝试改变一些常量值看看程序运行以不同的值运行的结果。

## 巩固

学习编程不一定非得是很复杂很有压力的过程。你需要在脑海中记住一些基本的概念。 

这就像建房子。要建成一座高塔，你要在一块一块砖往上砌。编程也是一样的。这些是堆砌编程必备的砖块：

* 对值进行操作需要 *操作符*
* 执行不同类型的操作比如数字类型的数学操作，或者字符串类型的输出，需要值和 *类型*
* 程序执行过程中你需要 *变量* 保存数据
* 你需要如 if 语句的 *条件语句* 来做决策
* 重复执行任务直到一个条件不再为true，你需要 *循环*
* 把你的代码有逻辑的组织成可以重复使用的代码块，你需要 *函数*

代码注释是写出可读性高的代码的有效方式，会让你的程序更易懂，更易维护，有问题的时候也更易修复。

最后，不要忽视联系的力量。 学习写代码最好的方式就是动手写代码。

我很激动你已经在学习编程的路上了。坚持。 不要忘记多看看其他的一些入门编程的资源（书啊，博客啊，在线培训之类的）。 这一章节和这本书是一个好的开始，但它只是简洁的介绍。

接下来的章节会巩固这一章节中的而很多概念，但是从 JavaScript 学习长远角度， 我们会在这一系列接下来的内容重点关注未来深入探讨的细节的大多数重要主题。

